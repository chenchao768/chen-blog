<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>js基础知识 | chen-blog</title>
    <meta name="description" content="努力！奋斗！">
    <link,[object Object] 0="meta" 1="[object Object]"></link,[object Object]>
    
    <link rel="preload" href="/chen-blog/assets/css/0.styles.936a4b08.css" as="style"><link rel="preload" href="/chen-blog/assets/js/app.b70c1746.js" as="script"><link rel="preload" href="/chen-blog/assets/js/2.49084ff2.js" as="script"><link rel="preload" href="/chen-blog/assets/js/13.75143207.js" as="script"><link rel="prefetch" href="/chen-blog/assets/js/10.0c73f6a1.js"><link rel="prefetch" href="/chen-blog/assets/js/11.2dca8060.js"><link rel="prefetch" href="/chen-blog/assets/js/12.08889f6e.js"><link rel="prefetch" href="/chen-blog/assets/js/14.9d4b5ce2.js"><link rel="prefetch" href="/chen-blog/assets/js/15.76f1c0e7.js"><link rel="prefetch" href="/chen-blog/assets/js/16.55165378.js"><link rel="prefetch" href="/chen-blog/assets/js/17.c9a51060.js"><link rel="prefetch" href="/chen-blog/assets/js/3.9d834fbe.js"><link rel="prefetch" href="/chen-blog/assets/js/4.87d01374.js"><link rel="prefetch" href="/chen-blog/assets/js/5.b81d79b1.js"><link rel="prefetch" href="/chen-blog/assets/js/6.65a5e62d.js"><link rel="prefetch" href="/chen-blog/assets/js/7.09d95517.js"><link rel="prefetch" href="/chen-blog/assets/js/8.70c794ce.js"><link rel="prefetch" href="/chen-blog/assets/js/9.9d1af347.js">
    <link rel="stylesheet" href="/chen-blog/assets/css/0.styles.936a4b08.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/chen-blog/" class="home-link router-link-active"><img src="/chen-blog/fk.jpg" alt="chen-blog" class="logo"> <span class="site-name can-hide">chen-blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/chen-blog/" class="nav-link">首页</a></div><div class="nav-item"><a href="/chen-blog/blog/life/" class="nav-link">生活</a></div><div class="nav-item"><a href="/chen-blog/blog/tec/" class="nav-link router-link-active">技术</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="联系" class="dropdown-title"><span class="title">联系</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://13222032892@163.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  邮箱
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><a href="https://github.com/chenchao768" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/chen-blog/" class="nav-link">首页</a></div><div class="nav-item"><a href="/chen-blog/blog/life/" class="nav-link">生活</a></div><div class="nav-item"><a href="/chen-blog/blog/tec/" class="nav-link router-link-active">技术</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="联系" class="dropdown-title"><span class="title">联系</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://13222032892@163.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  邮箱
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><a href="https://github.com/chenchao768" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/chen-blog/blog/tec/" class="sidebar-link">技术</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>js基础必须牢靠</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/chen-blog/blog/tec/js/js基础.html" class="active sidebar-link">语言基础</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>关于浏览器相关的知识</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>koa加油学</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>vue浅析各类原理</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>http解析</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="js基础知识"><a href="#js基础知识" class="header-anchor">#</a> js基础知识</h1> <h3 id="前端必会"><a href="#前端必会" class="header-anchor">#</a> 前端必会</h3> <hr> <p></p><div class="table-of-contents"><ul><li><a href="#前端必会">前端必会</a></li><li><a href="#bind和apply-call的区别">bind和apply,call的区别</a></li><li><a href="#apply函数的实现">apply函数的实现</a></li><li><a href="#call函数的实现">call函数的实现</a></li><li><a href="#bind函数的实现">bind函数的实现</a></li><li><a href="#简述原型链">简述原型链</a></li><li><a href="#实现new函数">实现new函数</a></li><li><a href="#判断数据类型">判断数据类型</a></li><li><a href="#关于函数执行上下文，作用域，函数调用的概念">关于函数执行上下文，作用域，函数调用的概念</a></li><li><a href="#关于this的指向在各个场景下的应用">关于this的指向在各个场景下的应用</a></li><li><a href="#async和await优劣势">async和await优劣势</a></li><li><a href="#关于垃圾回收机制">关于垃圾回收机制</a></li></ul></div><p></p> <h3 id="bind和apply-call的区别"><a href="#bind和apply-call的区别" class="header-anchor">#</a> bind和apply,call的区别</h3> <ol><li>bind是返回一个已绑定执行上下文的函数，而apply和call是执行一个已绑定执行上下文的函数</li> <li>apply函数接收一个上下文参数和一个参数数组，而call函数是接受一个上下文参数与一个序列化的参数列表</li> <li>举例：</li></ol> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token punctuation">{</span>
    value<span class="token punctuation">:</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">getValue</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">getValue</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token string">'yck'</span><span class="token punctuation">,</span> <span class="token string">'24'</span><span class="token punctuation">)</span>
<span class="token function">getValue</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'yck'</span><span class="token punctuation">,</span> <span class="token string">'24'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="apply函数的实现"><a href="#apply函数的实现" class="header-anchor">#</a> apply函数的实现</h3> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">myapply</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">content</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">let</span> context <span class="token operator">=</span> content <span class="token operator">||</span> window<span class="token punctuation">;</span>
	context<span class="token punctuation">.</span>fn <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
	<span class="token keyword">let</span> result<span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>arguments<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		result <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token operator">...</span>argument<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>	
	<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
		result <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">delete</span> context<span class="token punctuation">.</span>fn
	<span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="call函数的实现"><a href="#call函数的实现" class="header-anchor">#</a> call函数的实现</h3> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">mycall</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">content</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">let</span> context <span class="token operator">=</span> content <span class="token operator">||</span> window<span class="token punctuation">;</span>
	context<span class="token punctuation">.</span>fn <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
	<span class="token keyword">let</span> result<span class="token punctuation">;</span>
	<span class="token keyword">let</span> arg <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>arguments<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
	result <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token operator">...</span>arg<span class="token punctuation">)</span>
	<span class="token keyword">delete</span> context<span class="token punctuation">.</span>fn
	<span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="bind函数的实现"><a href="#bind函数的实现" class="header-anchor">#</a> bind函数的实现</h3> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">mybind</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">content</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token keyword">this</span> <span class="token operator">!==</span> <span class="token string">'function'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TypeError</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">let</span> _this <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
	<span class="token keyword">let</span> arg <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>arguments<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token comment">//返回一个函数</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token constant">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// 因为返回了一个函数，我们可以 new F()，所以需要判断</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token keyword">instanceof</span> <span class="token class-name">F</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">_this</span><span class="token punctuation">(</span><span class="token operator">...</span>arg<span class="token punctuation">,</span><span class="token operator">...</span>arguments<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token function">_this</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span>arg<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token operator">...</span>arguments<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="简述原型链"><a href="#简述原型链" class="header-anchor">#</a> 简述原型链</h3> <p><img src="/chen-blog/chain.jpg"><br></p> <ol><li>只要是Function的实例，那就是函数对象，其余则为普通对象。</li> <li><table><thead><tr><th>对象类型</th> <th style="text-align:center;">_<em>proto_</em></th> <th style="text-align:center;">prototype</th></tr></thead> <tbody><tr><td>普通对象</td> <td style="text-align:center;">true</td> <td style="text-align:center;">false</td></tr> <tr><td>函数对象</td> <td style="text-align:center;">true</td> <td style="text-align:center;">true</td></tr></tbody></table></li> <li>(1)实例的__proto__属性主动指向构造的 prototype;
(2)prototype 属性被 _<em>proto_</em> 属性 所指向。</li> <li>(1)任何内置函数对象本身的\ __proto__属性都指向 Function的原型对象，即：Function.prototype;
(2)除了 Object.prototype.__proto__指向 null ,所有的内置函数对象的原型对象的 __proto__属性 ( 内置函数对象.prototype._<em>proto_</em>)，都指向Object。</li></ol> <hr> <div class="custom-block tip"><p class="custom-block-title">ps:</p> <p>在判断原形链时可以将其分为3类</p></div> <blockquote><p>普通对象：obj是有new Object()实例化得来的,obj._<em>proto_</em>-&gt;Object.prototype,Object原形有一个_<em>proto_<em>和constructor(这个东西指向函数本身或者构造函数本身)<br>
普通函数：func的构造函数是Function,所以func._<em>proto</em></em> -&gt;Function.prototype,而Function.prototype的 _<em>proto</em></em> \又指向Object.prototype,另外func.prototype._<em>proto</em>_ \直接指向Object.prototype<br>
构造函数实例：比普通函数多一层实例指向构造函数其他同上</p></blockquote> <h3 id="实现new函数"><a href="#实现new函数" class="header-anchor">#</a> 实现new函数</h3> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">myNew</span><span class="token punctuation">(</span><span class="token parameter">Cons<span class="token punctuation">,</span><span class="token operator">...</span>args</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    obj<span class="token punctuation">.</span>__proto__ <span class="token operator">=</span> <span class="token class-name">Cons</span><span class="token punctuation">.</span>prototype<span class="token punctuation">;</span> <span class="token comment">//执行原型链接</span>
    <span class="token keyword">let</span> res <span class="token operator">=</span> <span class="token function">Cons</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">typeof</span> res <span class="token operator">===</span> <span class="token string">'object'</span> <span class="token operator">?</span> res <span class="token punctuation">:</span> obj<span class="token punctuation">;</span><span class="token comment">//相当于实例化一个obj继承于构造函数执行在实例的执行上下文</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="判断数据类型"><a href="#判断数据类型" class="header-anchor">#</a> 判断数据类型</h3> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">o</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	retrun <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token comment">//[object xxx]</span>
	<span class="token comment">//这里为什么需要使用Object.prototype来调toString方法，因为一些数据类型上的构造函数可能重写了</span>
	<span class="token comment">//toString方法，像数组，函数，字符串等本身都有toString方法，返回的会不一致</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="关于函数执行上下文，作用域，函数调用的概念"><a href="#关于函数执行上下文，作用域，函数调用的概念" class="header-anchor">#</a> 关于函数执行上下文，作用域，函数调用的概念</h3> <p>函数调用：执行构成函数主体的代码：例如，parseInt函数调用是parseInt('15')。</p> <hr> <p>调用上下文：在执行函数时this的指向，例如，map.set('key', 'value')的调用上下文是 map</p> <hr> <p>函数作用域：是在函数体中可访问的变量、对象和函数的集合。</p> <h3 id="关于this的指向在各个场景下的应用"><a href="#关于this的指向在各个场景下的应用" class="header-anchor">#</a> 关于this的指向在各个场景下的应用</h3> <h4 id="函数调用场景："><a href="#函数调用场景：" class="header-anchor">#</a> 函数调用场景：</h4> <blockquote><p>this 在函数调用中是一个全局对象，局对象由执行环境决定。在浏览器中，this是 window 对象。
坑：</p></blockquote> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> numbers <span class="token operator">=</span> <span class="token punctuation">{</span>
   numberA<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
   numberB<span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
   <span class="token function-variable function">sum</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">===</span> numbers<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; true</span>
     <span class="token keyword">function</span> <span class="token function">calculate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">===</span> numbers<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; false</span>
       <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>numberA <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>numberB<span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
     <span class="token keyword">return</span> <span class="token function">calculate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
numbers<span class="token punctuation">.</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; NaN ,调用时sum的this指向的是numbers但是内部函数执行时是函数调用指向window</span>
<span class="token comment">//如何改正：可以return calculate.call(this)(绑定执行上下文)或者该函数使用箭头函数绑定父级上下文</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h4 id="方法调用场景："><a href="#方法调用场景：" class="header-anchor">#</a> 方法调用场景：</h4> <blockquote><p>在方法调用中，this是拥有这个方法的对象</p></blockquote> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//例子</span>
<span class="token keyword">const</span> calc <span class="token operator">=</span> <span class="token punctuation">{</span>
  num<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token function-variable function">increment</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">===</span> calc<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; true</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>num <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>num<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// method invocation. this is calc</span>
calc<span class="token punctuation">.</span><span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; 1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><blockquote><p>坑：方法可以从对象中提取到一个单独的变量const alone = myObj.myMethod。当方法单独调用时，与原始对象alone()分离，你可能认为当前的this就是定义方法的对象myObject。</p></blockquote> <p>如果方法在没有对象的情况下调用，那么函数调用就会发生，此时的this指向全局对象window严格模式下是undefined。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>	<span class="token keyword">function</span> <span class="token function">Animal</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> legs</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>type <span class="token operator">=</span> type<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>legs <span class="token operator">=</span> legs<span class="token punctuation">;</span>  
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">logInfo</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">===</span> myCat<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; false</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'The '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>type <span class="token operator">+</span> <span class="token string">' has '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>legs <span class="token operator">+</span> <span class="token string">' legs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> myCat <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Animal</span><span class="token punctuation">(</span><span class="token string">'Cat'</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// The undefined has undefined legs </span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span>myCat<span class="token punctuation">.</span>logInfo<span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//调用settimeout的时候方法作为参数传入，会与器对象分离所以this为window</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>可以通过箭头函数或者bind来改变指向</p> <h4 id="构造函数调用场景"><a href="#构造函数调用场景" class="header-anchor">#</a> 构造函数调用场景</h4> <blockquote><p>在构造函数调用中 this 指向新创建的对象</p></blockquote> <h4 id="隐世调用（apply-call-bind）"><a href="#隐世调用（apply-call-bind）" class="header-anchor">#</a> 隐世调用（apply,call,bind）</h4> <blockquote><p>在隐式调用.call()或.apply(),bind()中，this是第一个参数</p></blockquote> <div class="custom-block warning"><p class="custom-block-title">注：</p> <p>.bind()创建一个永久的上下文链接，并始终保持它。 一个绑定函数不能通过.call()或者.apply()来改变它的上下文，甚至是再次绑定也不会有什么作用。</p></div> <h4 id="箭头函数"><a href="#箭头函数" class="header-anchor">#</a> 箭头函数</h4> <blockquote><p>this 定义箭头函数的封闭上下文,箭头函数不会创建自己的执行上下文，而是从定义它的外部函数中获取 this。 换句话说，箭头函数在词汇上绑定 this。
坑： 用箭头函数定义方法</p></blockquote> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Period</span> <span class="token punctuation">(</span><span class="token parameter">hours<span class="token punctuation">,</span> minutes</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
  <span class="token keyword">this</span><span class="token punctuation">.</span>hours <span class="token operator">=</span> hours<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>minutes <span class="token operator">=</span> minutes<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Period</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">format</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">===</span> window<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; true</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>hours <span class="token operator">+</span> <span class="token string">' hours and '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>minutes <span class="token operator">+</span> <span class="token string">' minutes'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>箭头函数的执行上下文也不可改变</p> <h3 id="async和await优劣势"><a href="#async和await优劣势" class="header-anchor">#</a> async和await优劣势</h3> <blockquote><p>async和await在处理异步操作时比promise更加清晰，不像promise需要不停的.then()进行链式调用代码更加清晰，但是滥用会造成代码阻塞，如果之后的异步操作不依赖前者，前者有错误会影响后续代码执行</p></blockquote> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">var</span> <span class="token function-variable function">b</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  a <span class="token operator">=</span> a <span class="token operator">+</span> <span class="token keyword">await</span> <span class="token number">10</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'2'</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span> <span class="token comment">// -&gt; '2' 10</span>
  a <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">await</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">+</span> a
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'3'</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span> <span class="token comment">// -&gt; '3' 20</span>
<span class="token punctuation">}</span>
<span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
a<span class="token operator">++</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span> <span class="token comment">// -&gt; '1' 1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><blockquote><p>首先函数 b 先执行，在执行到 await 10 之前变量 a 还是 0，因为在 await 内部实现了 generators ，generators 会保留堆栈中东西，所以这时候 a = 0 被保存了下来
因为 await 是异步操作，遇到await就会立即返回一个pending状态的Promise对象，暂时返回执行代码的控制权，使得函数外的代码得以继续执行，所以会先执行 console.log('1', a)
这时候同步代码执行完毕，开始执行异步代码，将保存下来的值拿出来使用，这时候 a = 10
然后后面就是常规执行代码了</p></blockquote> <h3 id="关于垃圾回收机制"><a href="#关于垃圾回收机制" class="header-anchor">#</a> 关于垃圾回收机制</h3> <h4 id="新生代算法-v8实现了准确gc算法"><a href="#新生代算法-v8实现了准确gc算法" class="header-anchor">#</a> 新生代算法(V8实现了准确GC算法)</h4> <blockquote><p>在新生代空间中，内存分为From空间和To空间，在这两个空间中两个空间必定有一个空间时使用的，还有一个是空置的
新分配的对象会被放在From空间中，当From空间占满的时候，将From空间中的还在使用的对象并复制到To空间中，失活的就销毁
当复制完成后将 From 空间和 To 空间互换，这样 GC 就结束了</p></blockquote> <h4 id="老生代算法"><a href="#老生代算法" class="header-anchor">#</a> 老生代算法</h4> <blockquote><p>老生代中的对象一般存活时间较长且数量也多，使用了两个算法，分别是标记清除算法和标记压缩算法。
在讲算法前，先来说下什么情况下对象会出现在老生代空间中：</p></blockquote> <p>新生代中的对象是否已经经历过一次 Scavenge 算法，如果经历过的话，会将对象从新生代空间移到老生代空间中。
To 空间的对象占比大小超过 25 %。在这种情况下，为了不影响到内存分配，会将对象从新生代空间移到老生代空间中。</p> <p>老生代中的空间很复杂，有如下几个空间</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">enum</span> AllocationSpace <span class="token punctuation">{</span>
  <span class="token comment">// TODO(v8:7464): Actually map this space's memory as read-only.</span>
  <span class="token constant">RO_SPACE</span><span class="token punctuation">,</span>    <span class="token comment">// 不变的对象空间</span>
  <span class="token constant">NEW_SPACE</span><span class="token punctuation">,</span>   <span class="token comment">// 新生代用于 GC 复制算法的空间</span>
  <span class="token constant">OLD_SPACE</span><span class="token punctuation">,</span>   <span class="token comment">// 老生代常驻对象空间</span>
  <span class="token constant">CODE_SPACE</span><span class="token punctuation">,</span>  <span class="token comment">// 老生代代码对象空间</span>
  <span class="token constant">MAP_SPACE</span><span class="token punctuation">,</span>   <span class="token comment">// 老生代 map 对象</span>
  <span class="token constant">LO_SPACE</span><span class="token punctuation">,</span>    <span class="token comment">// 老生代大空间对象</span>
  <span class="token constant">NEW_LO_SPACE</span><span class="token punctuation">,</span>  <span class="token comment">// 新生代大空间对象</span>

  <span class="token constant">FIRST_SPACE</span> <span class="token operator">=</span> <span class="token constant">RO_SPACE</span><span class="token punctuation">,</span>
  <span class="token constant">LAST_SPACE</span> <span class="token operator">=</span> <span class="token constant">NEW_LO_SPACE</span><span class="token punctuation">,</span>
  <span class="token constant">FIRST_GROWABLE_PAGED_SPACE</span> <span class="token operator">=</span> <span class="token constant">OLD_SPACE</span><span class="token punctuation">,</span>
  <span class="token constant">LAST_GROWABLE_PAGED_SPACE</span> <span class="token operator">=</span> <span class="token constant">MAP_SPACE</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>复制代码在老生代中，以下情况会先启动标记清除算法：</p> <p>某一个空间没有分块的时候
空间中被对象超过一定限制
空间不能保证新生代中的对象移动到老生代中</p> <p>在这个阶段中，会遍历堆中所有的对象，然后标记活的对象，在标记完成后，销毁所有没有被标记的对象。在标记大型对内存时，可能需要几百毫秒才能完成一次标记。这就会导致一些性能上的问题。为了解决这个问题，2011 年，V8 从 stop-the-world 标记切换到增量标志。在增量标记期间，GC 将标记工作分解为更小的模块，可以让 JS 应用逻辑在模块间隙执行一会，从而不至于让应用出现停顿情况。但在 2018 年，GC 技术又有了一个重大突破，这项技术名为并发标记。该技术可以让 GC 扫描和标记对象时，同时允许 JS 运行
清除对象后会造成堆内存出现碎片的情况，当碎片超过一定限制后会启动压缩算法。在压缩过程中，将活的对象像一端移动，直到所有对象都移动完成然后清理掉不需要的内存。</p> <h4 id="数组降维"><a href="#数组降维" class="header-anchor">#</a> 数组降维</h4> <p>直接上方法</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//数组降维  二维数组</span>
<span class="token comment">//第一种双层遍历</span>

<span class="token comment">//第二种concat</span>
<span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">deepFlat</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> _this <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">,</span>result<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>_this<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    result<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>_this<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> result
<span class="token punctuation">}</span>

<span class="token comment">//第三种 apply+concat</span>
<span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">deepFlat</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> _this <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>_this<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">//多维数组   递归</span>
<span class="token keyword">const</span> <span class="token function-variable function">deepFlat</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    result <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span>b</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token operator">...</span>a<span class="token punctuation">,</span><span class="token operator">...</span><span class="token function">deepFlat</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
    result <span class="token operator">=</span> <span class="token punctuation">[</span>arr<span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> result
<span class="token punctuation">}</span>

<span class="token comment">//多维数组  栈方法</span>
<span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">flatDeep</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> _this <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">,</span>result <span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>_this <span class="token operator">!==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> item <span class="token operator">=</span> _this<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      _this<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
      result<span class="token punctuation">.</span><span class="token function">unshift</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> result
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><h4 id="防抖和节流"><a href="#防抖和节流" class="header-anchor">#</a> 防抖和节流</h4> <div class="custom-block tip"><p class="custom-block-title">防抖函数</p> <p>它在用户不触发事件的时，才触发动作，并且抑制了本来在事件中要执行的动作。
其他应用场合：提交按钮的点击事件。</p></div> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//防抖</span>
<span class="token keyword">function</span> <span class="token function">debonus</span><span class="token punctuation">(</span><span class="token parameter">func<span class="token punctuation">,</span>wait</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">}</span>
    timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">func</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token operator">...</span>arguments<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>wait<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">节流函数</p> <p>函数节流会用在比input, keyup更频繁触发的事件中，如resize, touchmove, mousemove, scroll。throttle 会强制函数以固定的速率执行。因此这个方法比较适合应用于动画相关的场景。</p></div> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">throttle</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> threshhold</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token keyword">var</span> timeout
 <span class="token keyword">var</span> start <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">;</span>
 <span class="token keyword">var</span> threshhold <span class="token operator">=</span> threshhold <span class="token operator">||</span> <span class="token number">160</span>
 <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

 <span class="token keyword">var</span> context <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">,</span> args <span class="token operator">=</span> arguments<span class="token punctuation">,</span> curr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">0</span>
 
 <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timeout<span class="token punctuation">)</span><span class="token comment">//总是干掉事件回调</span>
 <span class="token keyword">if</span><span class="token punctuation">(</span>curr <span class="token operator">-</span> start <span class="token operator">&gt;=</span> threshhold<span class="token punctuation">)</span><span class="token punctuation">{</span> 
     console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;now&quot;</span><span class="token punctuation">,</span> curr<span class="token punctuation">,</span> curr <span class="token operator">-</span> start<span class="token punctuation">)</span><span class="token comment">//注意这里相减的结果，都差不多是160左右</span>
     <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> args<span class="token punctuation">)</span> <span class="token comment">//只执行一部分方法，这些方法是在某个时间段内执行一次</span>
     start <span class="token operator">=</span> curr
 <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
 <span class="token comment">//让方法在脱离事件后也能执行一次</span>
     timeout <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> args<span class="token punctuation">)</span> 
     <span class="token punctuation">}</span><span class="token punctuation">,</span> threshhold<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/chen-blog/blog/tec/" class="prev router-link-active">技术</a></span> <span class="next"><a href="/chen-blog/blog/tec/browser/浏览器相关.html">浏览器相关</a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/chen-blog/assets/js/app.b70c1746.js" defer></script><script src="/chen-blog/assets/js/2.49084ff2.js" defer></script><script src="/chen-blog/assets/js/13.75143207.js" defer></script>
  </body>
</html>
